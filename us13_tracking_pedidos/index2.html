<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>US-13 - CI/CD Pipeline</title>
    <style>
        /* Estilos específicos de CI/CD */
        :root {
            --primary-color: #000000;
            --secondary-color: #333333;
            --background-color: #ffffff;
            --surface-color: #f8f9fa;
            --border-color: #e0e0e0;
            --text-color: #000000;
            --text-light: #666666;
            --success-color: #000000;
            --warning-color: #ff9800;
            --error-color: #d32f2f;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --border-radius: 4px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Monaco', 'Courier New', monospace;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            padding: var(--spacing-md);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            font-size: 2rem;
            margin-bottom: var(--spacing-sm);
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
        }

        .pipeline-container {
            background: var(--surface-color);
            border-radius: var(--border-radius);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }

        .pipeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }

        .pipeline-status {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .status-success {
            background: #e8f5e8;
            color: var(--success-color);
        }

        .status-running {
            background: #e3f2fd;
            color: #1976d2;
        }

        .status-failed {
            background: #ffebee;
            color: var(--error-color);
        }

        .status-pending {
            background: #fff3e0;
            color: var(--warning-color);
        }

        .pipeline-stages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .stage-card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            text-align: center;
            transition: transform 0.3s;
        }

        .stage-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .stage-icon {
            font-size: 2rem;
            margin-bottom: var(--spacing-sm);
        }

        .stage-name {
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
        }

        .stage-status {
            font-size: 0.8rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: var(--spacing-sm);
        }

        .stage-duration {
            color: var(--text-light);
            font-size: 0.8rem;
        }

        .build-log {
            background: #1e1e1e;
            color: #d4d4d4;
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: var(--spacing-lg);
        }

        .log-line {
            margin-bottom: 0.25rem;
            white-space: pre-wrap;
        }

        .log-info {
            color: #569cd6;
        }

        .log-success {
            color: #4ec9b0;
        }

        .log-warning {
            color: #ffcc02;
        }

        .log-error {
            color: #f44747;
        }

        .pipeline-actions {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        .btn {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 2px solid var(--primary-color);
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            background: transparent;
            color: var(--primary-color);
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary-color);
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-success {
            background: var(--success-color);
            border-color: var(--success-color);
        }

        .btn-success:hover {
            background: transparent;
            color: var(--success-color);
        }

        .btn-danger {
            background: var(--error-color);
            border-color: var(--error-color);
        }

        .btn-danger:hover {
            background: transparent;
            color: var(--error-color);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .metric-card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            text-align: center;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-xs);
        }

        .metric-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .build-history {
            margin-top: var(--spacing-lg);
        }

        .history-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: var(--spacing-md);
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .history-table th {
            background: var(--surface-color);
            padding: var(--spacing-sm);
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid var(--border-color);
        }

        .history-table td {
            padding: var(--spacing-sm);
            border-bottom: 1px solid var(--border-color);
        }

        .history-table tr:last-child td {
            border-bottom: none;
        }

        .build-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin: var(--spacing-sm) 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--success-color);
            transition: width 0.3s ease;
        }

        .environment-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .env-dev {
            background: #e3f2fd;
            color: #1976d2;
        }

        .env-staging {
            background: #fff3e0;
            color: var(--warning-color);
        }

        .env-prod {
            background: #e8f5e8;
            color: var(--success-color);
        }

        .terminal-prompt::before {
            content: '$ ';
            color: #4ec9b0;
        }

        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">⚙️</div>
            <h1 class="section-title">CI/CD Pipeline</h1>
            <p>Continuous Integration & Continuous Deployment</p>
        </div>

        <div class="pipeline-container">
            <div class="pipeline-header">
                <div>
                    <h2>Build #${Math.random().toString(36).substr(2, 6).toUpperCase()}</h2>
                    <div style="color: var(--text-light); font-size: 0.9rem;">
                        Craft & Beer · Main Branch · ${new Date().toLocaleString()}
                    </div>
                </div>
                <div class="pipeline-status">
                    <div class="status-badge status-running">
                        <span class="spinner"></span>
                        EJECUTANDO
                    </div>
                    <div class="environment-badge env-dev">DEV</div>
                </div>
            </div>

            <div class="pipeline-stages">
                <div class="stage-card">
                    <div class="stage-icon">📥</div>
                    <div class="stage-name">Source</div>
                    <div class="stage-status status-success">COMPLETADO</div>
                    <div class="stage-duration">15s</div>
                </div>
                <div class="stage-card">
                    <div class="stage-icon">🔧</div>
                    <div class="stage-name">Build</div>
                    <div class="stage-status status-running">
                        <span class="spinner"></span>
                        EJECUTANDO
                    </div>
                    <div class="stage-duration">2m 15s</div>
                </div>
                <div class="stage-card">
                    <div class="stage-icon">🧪</div>
                    <div class="stage-name">Test</div>
                    <div class="stage-status status-pending">PENDIENTE</div>
                    <div class="stage-duration">--</div>
                </div>
                <div class="stage-card">
                    <div class="stage-icon">🚀</div>
                    <div class="stage-name">Deploy</div>
                    <div class="stage-status status-pending">PENDIENTE</div>
                    <div class="stage-duration">--</div>
                </div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" style="width: 40%;"></div>
            </div>

            <div class="pipeline-actions">
                <button class="btn btn-success" onclick="triggerBuild()">
                    ▶️ Trigger Build
                </button>
                <button class="btn btn-secondary" onclick="cancelBuild()">
                    ⏹️ Cancel Build
                </button>
                <button class="btn btn-danger" onclick="rollbackDeploy()">
                    🔄 Rollback
                </button>
                <button class="btn btn-secondary" onclick="deployToProd()">
                    🚀 Deploy to Prod
                </button>
            </div>

            <div class="build-log" id="buildLog">
                <div class="log-line log-info">[INFO] Starting CI/CD Pipeline execution...</div>
                <div class="log-line log-info">[INFO] Repository: https://github.com/craftbeer/ecommerce.git</div>
                <div class="log-line log-info">[INFO] Branch: main | Commit: a1b2c3d</div>
                <div class="log-line log-success">[SUCCESS] ✓ Source stage completed</div>
                <div class="log-line log-info">[INFO] Installing dependencies...</div>
                <div class="log-line terminal-prompt">npm install</div>
                <div class="log-line">added 245 packages in 15.2s</div>
                <div class="log-line log-info">[INFO] Building application...</div>
                <div class="log-line terminal-prompt">npm run build</div>
                <div class="log-line">webpack compiled successfully</div>
                <div class="log-line log-info">[INFO] Running linting...</div>
                <div class="log-line terminal-prompt">npm run lint</div>
                <div class="log-line">No lint errors found</div>
                <div class="log-line log-warning">[WARNING] Some dependencies have minor vulnerabilities</div>
                <div class="log-line log-info" id="currentLog">[INFO] Running unit tests...</div>
            </div>
        </div>

        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-value">98.7%</div>
                <div class="metric-label">Success Rate</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">2.3m</div>
                <div class="metric-label">Avg. Build Time</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">45</div>
                <div class="metric-label">Deploys This Month</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">0</div>
                <div class="metric-label">Active Incidents</div>
            </div>
        </div>

        <div class="build-history">
            <h3 class="history-title">Build History</h3>
            <table class="history-table">
                <thead>
                    <tr>
                        <th>Build #</th>
                        <th>Status</th>
                        <th>Environment</th>
                        <th>Duration</th>
                        <th>Timestamp</th>
                        <th>Commit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>#B7D4A2</td>
                        <td><span class="build-status status-success">SUCCESS</span></td>
                        <td><span class="environment-badge env-prod">PROD</span></td>
                        <td>2m 15s</td>
                        <td>15/03/2024 10:30</td>
                        <td>a1b2c3d</td>
                    </tr>
                    <tr>
                        <td>#C8E5B3</td>
                        <td><span class="build-status status-success">SUCCESS</span></td>
                        <td><span class="environment-badge env-staging">STAGING</span></td>
                        <td>2m 08s</td>
                        <td>15/03/2024 09:15</td>
                        <td>f4e5d6c</td>
                    </tr>
                    <tr>
                        <td>#D9F6C4</td>
                        <td><span class="build-status status-failed">FAILED</span></td>
                        <td><span class="environment-badge env-dev">DEV</span></td>
                        <td>1m 45s</td>
                        <td>14/03/2024 16:20</td>
                        <td>b7c8d9e</td>
                    </tr>
                    <tr>
                        <td>#E0G7D5</td>
                        <td><span class="build-status status-success">SUCCESS</span></td>
                        <td><span class="environment-badge env-prod">PROD</span></td>
                        <td>2m 22s</td>
                        <td>14/03/2024 14:00</td>
                        <td>c9d0e1f</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        let logInterval;

        function simulateBuildLog() {
            const logContainer = document.getElementById('buildLog');
            const currentLog = document.getElementById('currentLog');
            
            const logEntries = [
                '[INFO] Running unit tests...',
                '[SUCCESS] ✓ All unit tests passed (45/45)',
                '[INFO] Running integration tests...',
                '[SUCCESS] ✓ Integration tests completed',
                '[INFO] Running E2E tests...',
                '[SUCCESS] ✓ E2E tests passed',
                '[INFO] Building Docker image...',
                '[SUCCESS] ✓ Docker image built successfully',
                '[INFO] Scanning for vulnerabilities...',
                '[SUCCESS] ✓ No critical vulnerabilities found',
                '[INFO] Pushing to container registry...',
                '[SUCCESS] ✓ Image pushed to registry',
                '[INFO] Deploying to development environment...',
                '[SUCCESS] ✓ Deployment completed successfully',
                '[SUCCESS] 🎉 CI/CD Pipeline completed successfully!'
            ];

            let index = 0;
            
            logInterval = setInterval(() => {
                if (index < logEntries.length) {
                    const entry = logEntries[index];
                    const logLine = document.createElement('div');
                    
                    if (entry.includes('[SUCCESS]')) {
                        logLine.className = 'log-line log-success';
                    } else if (entry.includes('[INFO]')) {
                        logLine.className = 'log-line log-info';
                    } else if (entry.includes('[WARNING]')) {
                        logLine.className = 'log-line log-warning';
                    } else if (entry.includes('[ERROR]')) {
                        logLine.className = 'log-line log-error';
                    } else {
                        logLine.className = 'log-line';
                    }
                    
                    logLine.textContent = entry;
                    logContainer.appendChild(logLine);
                    logContainer.scrollTop = logContainer.scrollHeight;
                    
                    index++;
                } else {
                    clearInterval(logInterval);
                    // Actualizar estado a completado
                    document.querySelector('.status-badge').className = 'status-badge status-success';
                    document.querySelector('.status-badge').innerHTML = 'COMPLETADO';
                }
            }, 1000);
        }

        function triggerBuild() {
            clearInterval(logInterval);
            document.getElementById('buildLog').innerHTML = `
                <div class="log-line log-info">[INFO] Starting new CI/CD Pipeline execution...</div>
                <div class="log-line log-info" id="currentLog">[INFO] Initializing build environment...</div>
            `;
            
            document.querySelector('.status-badge').className = 'status-badge status-running';
            document.querySelector('.status-badge').innerHTML = '<span class="spinner"></span> EJECUTANDO';
            
            simulateBuildLog();
            alert('🔄 Triggering new build...');
        }

        function cancelBuild() {
            clearInterval(logInterval);
            const logContainer = document.getElementById('buildLog');
            logContainer.innerHTML += '<div class="log-line log-error">[ERROR] Build cancelled by user</div>';
            document.querySelector('.status-badge').className = 'status-badge status-failed';
            document.querySelector('.status-badge').innerHTML = 'CANCELADO';
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function rollbackDeploy() {
            if (confirm('¿Estás seguro de que quieres hacer rollback a la versión anterior?')) {
                alert('🔄 Starting rollback to previous version...');
                // Simular rollback
                setTimeout(() => {
                    alert('✅ Rollback completed successfully');
                }, 2000);
            }
        }

        function deployToProd() {
            if (confirm('¿Estás seguro de que quieres desplegar a producción?')) {
                alert('🚀 Deploying to production environment...');
                // Simular deploy
                setTimeout(() => {
                    alert('✅ Production deployment completed successfully');
                }, 3000);
            }
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            simulateBuildLog();
        });
    </script>
</body>
</html>